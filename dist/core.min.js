!function(self){if(typeof exports!=="undefined"&&exports)Object.keys(self).map(function(k){exports[k]=self[k]});else if(typeof window!=="undefined"&&window)window.KorUtil=self;else if(typeof global!=="undefined"&&global)global.KorUtil=self;else console.error("GLOBAL OBJECT NOT FOUND")}(function(MODULE_NAME){const self=typeof KorUtil!="undefined"&&KorUtil||{modules:{}};self.modules[MODULE_NAME]=true;self._test=function(str){};self.isKoreanPhoneme=function(char,autoConv){return/^[\u3131-\u3163]/.test(char)||autoConv&&INDEXING_ARRAY__KO_PHONEME.indexOf(char)>=0||false};self.isConsonant=function(char,autoConv){return/^[\u3131-\u314e]/.test(char)||autoConv&&CHAR_CODE_AT_KO_PHONEME_BEGIN<=char.charCodeAt(0)&&char.charCodeAt(0)<CHAR_CODE_AT_KO_PHONEME_BEGIN+CHAR_COUNT__KO_CONSONANT||false};self.isFirstSound=function(char,autoConv){return autoConv&&Boolean(1+INDEXING_ARRAY__KO_CONSONANT.indexOf(char))||Boolean(1+INDEXING_ARRAY__KO_CONSONANT.indexOf(convertAlphabetToPhoneme(char)))||false};self.isVowel=self.isMidSound=function(char,autoConv){var n=char.charCodeAt(0);return/^[\u314f-\u3163]/.test(char)||autoConv&&CHAR_COUNT__KO_CONSONANT<=INDEXING_ARRAY__KO_PHONEME.indexOf(char)};self.isLastSound=function(char,autoConv){return autoConv&&Boolean(1+INDEXING_ARRAY__KO_LAST_SOUND.indexOf(char))||Boolean(1+INDEXING_ARRAY__KO_LAST_SOUND.indexOf(convertAlphabetToPhoneme(char)))||false};self.convertAlphabetToPhoneme=function(char,defaultValue,caseInsencitive){var ci;if(typeof defaultValue=="boolean"||typeof defaultValue!="string"&&typeof caseInsencitive=="string"){ci=defaultValue;defaultValue=caseInsencitive}else ci=caseInsencitive;if(INDEXING_ARRAY__KO_PHONEME.indexOf(char)>=0)return convertAlphabetToPhoneme(char);if(ci)for(var i=0;i<INDEXING_ARRAY__KO_PHONEME.length;i++)if(INDEXING_ARRAY__KO_PHONEME[i].toLowerCase()==char.toLowerCase())return convertAlphabetToPhoneme(INDEXING_ARRAY__KO_PHONEME[i]);return defaultValue===undefined?char:defaultValue};self.convertPhonemeToAlphabet=function(char,defaultValue){return/\u3131-\u3163/i.test(char)?convertAlphabetToPhoneme(char):defaultValue};self.isKoreanChar=function(char){return/^[\uac00-\ud7a3]/.test(char)};self.isKorean=function(str){return/^[\u3131-\u3163\uac00-\ud7a3]+$/.test(str)};self.indexOfKorean=function(str){var m=str.match(/[\u3131-\u3163\uac00-\ud7a3]/);return m?m.index:-1};self.indexOfKoreanChar=function(str){var m=str.match(/[\uac00-\ud7a3]/);return m?m.index:-1};self.indexOfKoreanPhoneme=function(str){var m=str.match(/[\u3131-\u3163]/);return m?m.index:-1};self.hasLastSound=function(str){var c=str.substr(-1).charCodeAt(0)||0;if(c<CHAR_CODE_AT_KO_CHAR_BEGIN)return false;if(c>=CHAR_CODE_AT_KO_CHAR_BEGIN+CHAR_COUNT__KO_CHAR)return false;c-=CHAR_CODE_AT_KO_CHAR_BEGIN;return c%CHAR_COUNT_PER_KO_MID_SOUND>0};self.koreanify=function(str){return convertAlphabetsToKorean(str)};self.qwerty=function(str){return self.split(str).split("").map(function(c){if(self.isKoreanChar(c))return self.split(c).split("").map(c=>self.qwerty(c)).join("");if(self.isKoreanPhoneme(c))return INDEXING_ARRAY__KO_PHONEME[c.charCodeAt(0)-CHAR_CODE_AT_KO_PHONEME_BEGIN];return c}).join("")};self.split=function(str){return str.split("").map(function(c){if(!self.isKoreanChar(c))return c;var a=["","",""],n=c.charCodeAt(0)-CHAR_CODE_AT_KO_CHAR_BEGIN,m;m=n%CHAR_COUNT_PER_KO_MID_SOUND;a[2]=INDEXING_ARRAY__KO_LAST_SOUND[m];a[2]=a[2]&&String.fromCharCode(CHAR_CODE_AT_KO_PHONEME_BEGIN+INDEXING_ARRAY__KO_PHONEME.indexOf(a[2]))||"";m=n%CHAR_COUNT_PER_KO_FIRST_SOUND;m=Math.floor(m/CHAR_COUNT_PER_KO_MID_SOUND);a[1]=String.fromCharCode(CHAR_CODE_AT_KO_PHONEME_BEGIN+CHAR_COUNT__KO_CONSONANT+m);m=Math.floor(n/CHAR_COUNT_PER_KO_FIRST_SOUND);a[0]=INDEXING_ARRAY__KO_CONSONANT[m];a[0]=String.fromCharCode(CHAR_CODE_AT_KO_PHONEME_BEGIN+INDEXING_ARRAY__KO_PHONEME.indexOf(a[0]));return a.join("")}).join("")};self.spread=function(str){return str.split("").map(function(c){if(!self.isKorean(c))return c;return self.qwerty(c).split("").map(c=>convertAlphabetToPhoneme(c)).join("")}).join("")};self.compress=function(str){return convertAlphabetsToKorean(str.split("").map(c=>self.isKoreanPhoneme(c)?convertPhonemeToAlphabet(c):c).join(""))};function convertAlphabetsToKorean(str){function _compress(a){if(a.length==0)return"";if(a.length==1)return String.fromCharCode(CHAR_CODE_AT_KO_PHONEME_BEGIN+INDEXING_ARRAY__KO_PHONEME.indexOf(INDEXING_ARRAY__KO_CONSONANT[a[0]]));if(a.length==2&&a[0]==null)return String.fromCharCode(CHAR_CODE_AT_KO_PHONEME_BEGIN+CHAR_COUNT__KO_CONSONANT+a[1]);var n=CHAR_CODE_AT_KO_CHAR_BEGIN;if(a.length)n+=a.shift()*CHAR_COUNT_PER_KO_FIRST_SOUND;if(a.length)n+=a.shift()*CHAR_COUNT_PER_KO_MID_SOUND;if(a.length)n+=a.shift();return String.fromCharCode(n)+(a.length?_compress(a):"")}if(!str)return"";var ret="",wait=[];for(var i=0;i<str.length;i++){var c=str.charAt(i),cc=c+(i<str.length-1?str.charAt(i+1):"_"),xc=i<str.length-2?str.charAt(i+2):"_";if(wait.length!=1&&self.isVowel(c,1)){if(wait.length>1)--i;else{if(self.isVowel(cc,1)){++i;ret+=_compress([null,convertPhonemeToMidSoundIndex(cc)])}else ret+=_compress([null,convertPhonemeToMidSoundIndex(c)]);continue}}else switch(wait.length){case 0:if(self.isFirstSound(c,1)){wait.push(convertPhonemeToFirstSoundIndex(c));continue}break;case 1:if(self.isMidSound(cc,1)){++i;wait.push(convertPhonemeToMidSoundIndex(cc));continue}if(self.isMidSound(c,1)){wait.push(convertPhonemeToMidSoundIndex(c));continue}break;case 2:if(self.isLastSound(cc,1)&&!self.isVowel(xc,1)){++i;wait.push(convertPhonemeToLastSoundIndex(cc))}else if(self.isLastSound(c,1)&&!self.isVowel(cc[1],1)){wait.push(convertPhonemeToLastSoundIndex(c))}if(wait.length>2)++i;break}if(wait.length){ret+=_compress(wait);wait=[];i--}else ret+=c}return ret+_compress(wait)}function convertAlphabetToPhoneme(c){return String.fromCharCode(CHAR_CODE_AT_KO_PHONEME_BEGIN+INDEXING_ARRAY__KO_PHONEME.indexOf(c))}function convertPhonemeToAlphabet(c,d){return INDEXING_ARRAY__KO_PHONEME[c.charCodeAt(0)-CHAR_CODE_AT_KO_PHONEME_BEGIN]}function convertPhonemeToFirstSoundIndex(phon){return INDEXING_ARRAY__KO_CONSONANT.indexOf(phon)}function convertPhonemeToMidSoundIndex(phon){var i=INDEXING_ARRAY__KO_PHONEME.indexOf(phon)-CHAR_COUNT__KO_CONSONANT;return i<0?-1:i}function convertPhonemeToLastSoundIndex(phon){return INDEXING_ARRAY__KO_LAST_SOUND.indexOf(phon)}const CHAR_CODE_AT_KO_CHAR_BEGIN=44032;const CHAR_COUNT__KO_CHAR=11172;const CHAR_COUNT_PER_KO_MID_SOUND=28;const CHAR_COUNT_PER_KO_FIRST_SOUND=588;self.getCharCodeAtKoreanCharBegin=function(){return CHAR_CODE_AT_KO_CHAR_BEGIN};self.getKoreanCharCount=function(){return CHAR_COUNT__KO_CHAR};self.getKoreanCharCountPerFirstSound=function(){return CHAR_COUNT_PER_KO_FIRST_SOUND};self.getKoreanCharCountPerMidSound=function(){return CHAR_COUNT_PER_KO_MID_SOUND};const CHAR_CODE_AT_KO_PHONEME_BEGIN=12593;const CHAR_COUNT__KO_CONSONANT=30;const CHAR_COUNT__KO_VOWEL=21;self.getCharCodeAtKoreanPhonemeBegin=function(){return CHAR_CODE_AT_KO_PHONEME_BEGIN};self.getKoreanConsonantCount=function(){return CHAR_COUNT__KO_CONSONANT};self.getKoreanVowelCount=function(){return CHAR_COUNT__KO_VOWEL};const INDEXING_ARRAY__KO_PHONEME=["r","R","rt","s","sw","sg","e","E","f","fr","fa","fq","ft","fx","fv","fg","a","q","Q","qt","t","T","d","w","W","c","z","x","v","g","k","o","i","O","j","p","u","P","h","hk","ho","hl","y","n","nj","np","nl","b","m","ml","l"];const INDEXING_ARRAY__KO_CONSONANT=["r","R","s","e","E","f","a","q","Q","t","T","d","w","W","c","z","x","v","g"];const INDEXING_ARRAY__KO_LAST_SOUND=["","r","R","rt","s","sw","sg","e","f","fr","fa","fq","ft","fx","fv","fg","a","q","qt","t","T","d","w","c","z","x","v","g"];return self}("core"));